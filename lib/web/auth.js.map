{"version":3,"sources":["web/auth.js"],"names":["authWithMilkcocoa","options","appId","transport","windowTitle","endpoint","callback","Error","url","encodeURIComponent","window","location","href","transportWindow","windowFeatures","child","open","addListener","e","data","w","event","cb"],"mappings":";;;;;QAAgBA,iB,GAAAA,iB;AAAT,SAASA,iBAAT,CAA4BC,OAA5B,EAAqC;AAC1C,MAAIC,QAAQD,QAAQC,KAApB;AACA,MAAIC,YAAYF,QAAQE,SAAR,IAAqB,QAArC;AACA,MAAIC,cAAcH,QAAQG,WAAR,IAAuB,OAAzC;AACA,MAAIC,WAAWJ,QAAQI,QAAR,IAAoB,mCAAnC;AACA,MAAIC,WAAWL,QAAQK,QAAvB;;AAEA,MAAI,CAACA,QAAL,EAAe,MAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;;AAEf,MAAIC,MAAMH,gCAA6BH,KAA7B,8BAA4DO,mBAAmBC,OAAOC,QAAP,CAAgBC,IAAnC,CAAtE;;AAEA,MAAIT,cAAc,QAAlB,EAA4B;AAC1BU,oBAAgBL,GAAhB;AACD,GAFD,MAEO,IAAIL,cAAc,UAAlB,EAA8B;AACnCU,oBAAgBL,GAAhB;AACD,GAFM,MAEA;AACL,UAAM,IAAID,KAAJ,CAAU,mBAAV,CAAN;AACD;;AAMD,WAASM,eAAT,CAA0BL,GAA1B,EAA+B;AAC7B,QAAIM,iBAAiB;AACnB,iBAAW,CADQ;AAEnB,kBAAY,CAFO;AAGnB,mBAAa,CAHM;AAInB,oBAAc,CAJK;AAKnB,gBAAU,CALS;AAMnB,gBAAU,CANS;AAOnB,eAAS,GAPU;AAQnB,gBAAU;AARS,KAArB;;AAWA,QAAIC,QAAQL,OAAOM,IAAP,CAAYR,GAAZ,EAAiBJ,WAAjB,EAA8BU,cAA9B,CAAZ;;AAEAG,gBAAYF,KAAZ,EAAmB,QAAnB,EAA6B,YAAY,CACxC,CADD;;AAGAE,gBAAYP,MAAZ,EAAoB,SAApB,EAA+B,UAAUQ,CAAV,EAAa;AAC1C,UAAIA,KAAKA,EAAEC,IAAX,EAAiB;AAAEb,iBAASY,EAAEC,IAAX;AAAkB;AACtC,KAFD;AAGD;;AAED,WAASF,WAAT,CAAsBG,CAAtB,EAAyBC,KAAzB,EAAgCC,EAAhC,EAAoC;AAClC,QAAIF,EAAE,aAAF,CAAJ,EAAsBA,EAAE,aAAF,EAAiB,OAAOC,KAAxB,EAA+BC,EAA/B,EAAtB,KACK,IAAIF,EAAE,kBAAF,CAAJ,EAA2BA,EAAE,kBAAF,EAAsBC,KAAtB,EAA6BC,EAA7B,EAAiC,KAAjC;AACjC;AACF","file":"auth.js","sourcesContent":["export function authWithMilkcocoa (options) {\n  let appId = options.appId\n  let transport = options.transport || 'window'\n  let windowTitle = options.windowTitle || 'Login'\n  let endpoint = options.endpoint || 'https://milkcocoav3.herokuapp.com'\n  let callback = options.callback\n\n  if (!callback) throw new Error('callback should be setted')\n\n  var url = endpoint + `/auth-api/auth/${appId}/mlkcca?redirect_uri=` + encodeURIComponent(window.location.href)\n\n  if (transport === 'window') {\n    transportWindow(url)\n  } else if (transport === 'redirect') {\n    transportWindow(url)\n  } else {\n    throw new Error('invalid transport')\n  }\n\n  // function transportRedirect (url) {\n  //   window.location = url\n  // }\n\n  function transportWindow (url) {\n    var windowFeatures = {\n      'menubar': 1,\n      'location': 0,\n      'resizable': 0,\n      'scrollbars': 1,\n      'status': 0,\n      'dialog': 1,\n      'width': 700,\n      'height': 375\n    }\n\n    var child = window.open(url, windowTitle, windowFeatures)\n\n    addListener(child, 'unload', function () {\n    })\n\n    addListener(window, 'message', function (e) {\n      if (e && e.data) { callback(e.data) }\n    })\n  }\n\n  function addListener (w, event, cb) {\n    if (w['attachEvent']) w['attachEvent']('on' + event, cb)\n    else if (w['addEventListener']) w['addEventListener'](event, cb, false)\n  }\n}\n"]}