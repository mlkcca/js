{"version":3,"sources":["web/auth.js"],"names":["authWithMilkcocoa","options","appId","transport","windowTitle","endpoint","callback","Error","url","encodeURIComponent","window","location","href","transport_window","transport_redirect","window_features","child","open","addListener","e","data","w","event","cb"],"mappings":";;;;;QAAgBA,iB,GAAAA,iB;AAAT,SAASA,iBAAT,CAA2BC,OAA3B,EAAoC;AAC1C,KAAIC,QAAQD,QAAQC,KAApB;AACA,KAAIC,YAAYF,QAAQE,SAAR,IAAqB,QAArC;AACA,KAAIC,cAAcH,QAAQG,WAAR,IAAuB,OAAzC;AACA,KAAIC,WAAWJ,QAAQI,QAAR,IAAoB,mCAAnC;AACA,KAAIC,WAAWL,QAAQK,QAAvB;;AAEA,KAAG,CAACA,QAAJ,EAAc,MAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;;AAEd,KAAIC,MAAMH,gCAA6BH,KAA7B,8BAA4DO,mBAAmBC,OAAOC,QAAP,CAAgBC,IAAnC,CAAtE;;AAEA,KAAGT,aAAa,QAAhB,EACCU,iBAAiBL,GAAjB,EADD,KAEK,IAAGL,aAAa,UAAhB,EACJU,iBAAiBL,GAAjB,EADI,KAGJ,MAAM,IAAID,KAAJ,CAAU,mBAAV,CAAN;;AAED,UAASO,kBAAT,CAA4BN,GAA5B,EAAiC;AAChCE,SAAOC,QAAP,GAAkBH,GAAlB;AACA;;AAED,UAASK,gBAAT,CAA0BL,GAA1B,EAA+B;AAC9B,MAAIO,kBAAkB;AAClB,cAAe,CADG;AAElB,eAAe,CAFG;AAGlB,gBAAe,CAHG;AAIlB,iBAAe,CAJG;AAKlB,aAAe,CALG;AAMlB,aAAe,CANG;AAOlB,YAAe,GAPG;AAQlB,aAAe;AARG,GAAtB;;AAWE,MAAIC,QAAQN,OAAOO,IAAP,CAAYT,GAAZ,EAAiBJ,WAAjB,EAA8BW,eAA9B,CAAZ;;AAEAG,cAAYF,KAAZ,EAAmB,QAAnB,EAA6B,YAAW,CACvC,CADD;;AAGAE,cAAYR,MAAZ,EAAoB,SAApB,EAA+B,UAASS,CAAT,EAAY;AAC1C,OAAGA,KAAKA,EAAEC,IAAV,EACCd,SAASa,EAAEC,IAAX;AACD,GAHD;AAIF;;AAED,UAASF,WAAT,CAAqBG,CAArB,EAAwBC,KAAxB,EAA+BC,EAA/B,EAAmC;AAClC,MAAIF,EAAE,aAAF,CAAJ,EAAsBA,EAAE,aAAF,EAAiB,OAAOC,KAAxB,EAA+BC,EAA/B,EAAtB,KACK,IAAIF,EAAE,kBAAF,CAAJ,EAA2BA,EAAE,kBAAF,EAAsBC,KAAtB,EAA6BC,EAA7B,EAAiC,KAAjC;AAChC;AAED","file":"auth.js","sourcesContent":["export function authWithMilkcocoa(options) {\n\tlet appId = options.appId;\n\tlet transport = options.transport || 'window';\n\tlet windowTitle = options.windowTitle || 'Login';\n\tlet endpoint = options.endpoint || 'https://milkcocoav3.herokuapp.com';\n\tlet callback = options.callback;\n\n\tif(!callback) throw new Error('callback should be setted');\n\n\tvar url = endpoint + `/auth-api/auth/${appId}/mlkcca?redirect_uri=` + encodeURIComponent(window.location.href);\n\n\tif(transport == 'window')\n\t\ttransport_window(url);\n\telse if(transport == 'redirect')\n\t\ttransport_window(url);\n\telse\n\t\tthrow new Error('invalid transport');\n\n\tfunction transport_redirect(url) {\n\t\twindow.location = url;\n\t}\n\n\tfunction transport_window(url) {\n\t\tvar window_features = {\n\t\t    'menubar'    : 1,\n\t\t    'location'   : 0,\n\t\t    'resizable'  : 0,\n\t\t    'scrollbars' : 1,\n\t\t    'status'     : 0,\n\t\t    'dialog'     : 1,\n\t\t    'width'      : 700,\n\t\t    'height'     : 375\n\t\t};\n\n\t  \tvar child = window.open(url, windowTitle, window_features);\n\n\t  \taddListener(child, 'unload', function() {\n\t  \t});\n\t\t\t\n\t  \taddListener(window, 'message', function(e) {\n\t  \t\tif(e && e.data)\n\t\t  \t\tcallback(e.data);\n\t  \t});\n\t}\n\n\tfunction addListener(w, event, cb) {\n\t\tif (w['attachEvent']) w['attachEvent']('on' + event, cb);\n\t\telse if (w['addEventListener']) w['addEventListener'](event, cb, false);\n\t}\n\n}\n"]}