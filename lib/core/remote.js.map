{"version":3,"sources":["core/remote.js"],"names":["ajax","require","host","port","secure","headers","path","params","_qs","_headers","qs","Object","assign","Promise","resolve","reject","pureURL","newQs","match","matched","replace","newQ","parse","request","JSON","stringify","err","data","content","newParams","cb","keys","forEach","k"],"mappings":"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","file":"remote.js","sourcesContent":["import querystring from 'querystring'\nvar ajax = require('./ajax')\n\nexport default class {\n  constructor (host, port, secure, headers) {\n    this.host = host\n    this.port = port\n    this.secure = secure\n    this.headers = headers\n  }\n\n  post (path, params, _qs, _headers) {\n    let qs = _qs || {}\n    let headers = Object.assign({}, this.headers, _headers)\n    return new Promise((resolve, reject) => {\n      var pureURL = path\n      var newQs = qs\n      if (path.match(/(\\?.*$)/)) {\n        var matched = path.match(/(\\?.*$)/)[0]\n        pureURL = path.replace(matched, '')\n        matched = matched.replace(/\\+/g, '%2B')\n        var newQ = querystring.parse(matched.replace('?', ''))\n        newQs = Object.assign({}, newQs, newQ)\n      }\n      ajax.request('POST', this.secure, this.host, this.port, pureURL, newQs, JSON.stringify(params), headers, function (err, data) {\n        if (err) {\n          return reject(err)\n        }\n        if (data.err) {\n          return reject(data.err)\n        }\n        resolve(data.content)\n      })\n    })\n  }\n\n  get (path, params) {\n    /*\n    var qs = {};\n    Object.keys(params).forEach(function(k) {\n      qs[k] = JSON.stringify(params[k]);\n    })\n    */\n    return new Promise((resolve, reject) => {\n      var pureURL = path\n      var newParams = params\n      if (path.match(/(\\?.*$)/)) {\n        var matched = path.match(/(\\?.*$)/)[0]\n        pureURL = path.replace(matched, '')\n        matched = matched.replace(/\\+/g, '%2B')\n        var newQ = querystring.parse(matched.replace('?', ''))\n        newParams = Object.assign({}, newParams, newQ)\n      }\n\n      ajax.request('GET', this.secure, this.host, this.port, pureURL, newParams, null, this.headers, function (err, data) {\n        if (err) {\n          return reject(err)\n        }\n        /*\n        if(data.err) {\n          return reject(data.err);\n        }\n        */\n        resolve(data)\n      })\n    })\n  }\n\n  get2 (path, params, cb) {\n    var pureURL = path\n    var newParams = params\n    if (path.match(/(\\?.*$)/)) {\n      var matched = path.match(/(\\?.*$)/)[0]\n      pureURL = path.replace(matched, '')\n      matched = matched.replace(/\\+/g, '%2B')\n      var newQ = querystring.parse(matched.replace('?', ''))\n      newParams = Object.assign({}, newParams, newQ)\n    }\n    return ajax.request('GET', this.secure, this.host, this.port, pureURL, newParams, null, this.headers, function (err, data) {\n      if (err) {\n        return cb(err)\n      }\n      cb(null, data)\n    })\n  }\n\n  put (path, params) {\n    return new Promise((resolve, reject) => {\n      ajax.request('PUT', this.secure, this.host, this.port, path, null, JSON.stringify(params), this.headers, function (err, data) {\n        if (err) {\n          return reject(err)\n        }\n        if (data.err) {\n          return reject(data.err)\n        }\n        resolve(data.content)\n      })\n    })\n  }\n\n  delete (path, params) {\n    var qs = {}\n    Object.keys(params).forEach(function (k) {\n      qs[k] = JSON.stringify(params[k])\n    })\n    return new Promise((resolve, reject) => {\n      ajax.request('DELETE', this.secure, this.host, this.port, path, qs, null, this.headers, function (err, data) {\n        if (err) {\n          return reject(err)\n        }\n        if (data.err) {\n          return reject(data.err)\n        }\n        resolve(data.content)\n      })\n    })\n  }\n}\n"]}