{"version":3,"sources":["core/ws.js"],"names":["WebSocket","isBrowser","process","title","require","window","EventEmitter","host","options","client","onerror","fire","onclose","onopen","onmessage","msg","emit","data","on","send","e","params"],"mappings":";;;;;;;;;;;;;;AAAA,IAAIA,YAAY,IAAhB;AACA,IAAIC,YAAY,KAAhB;;AAEA,IAAI,cAAcC,QAAQC,KAA1B,EAAiC;AAChCH,aAAYI,QAAQ,IAAR,CAAZ;AACA,CAFD,MAEK;AACJH,aAAY,IAAZ;AACAD,aAAYK,OAAOL,SAAnB;AACA;;AAED,IAAIM,eAAeF,QAAQ,QAAR,EAAkBE,YAArC;;;;;AAGC,iBAAYC,IAAZ,EAAkBC,OAAlB,EAA2B;AAAA;;AAAA;;AAE1B,MAAGP,SAAH,EAAc;AACb,SAAKQ,MAAL,GAAc,IAAIT,SAAJ,CAAcO,IAAd,CAAd;AACA,SAAKE,MAAL,CAAYC,OAAZ,GAAsB,MAAKC,IAAL,CAAU,OAAV,CAAtB;AACA,SAAKF,MAAL,CAAYG,OAAZ,GAAsB,MAAKD,IAAL,CAAU,OAAV,CAAtB;AACA,SAAKF,MAAL,CAAYI,MAAZ,GAAqB,MAAKF,IAAL,CAAU,MAAV,CAArB;AACA,SAAKF,MAAL,CAAYK,SAAZ,GAAwB,UAACC,GAAD,EAAS;AAChC,UAAKC,IAAL,CAAU,SAAV,EAAqBD,IAAIE,IAAzB;AACA,IAFD;AAGA,GARD,MAQK;AACJ,SAAKR,MAAL,GAAc,IAAIT,SAAJ,CAAcO,IAAd,EAAoBC,OAApB,CAAd;AACA,SAAKC,MAAL,CAAYS,EAAZ,CAAe,OAAf,EAAwB,MAAKP,IAAL,CAAU,OAAV,CAAxB;AACA,SAAKF,MAAL,CAAYS,EAAZ,CAAe,OAAf,EAAwB,MAAKP,IAAL,CAAU,OAAV,CAAxB;AACA,SAAKF,MAAL,CAAYS,EAAZ,CAAe,MAAf,EAAuB,MAAKP,IAAL,CAAU,MAAV,CAAvB;AACA,SAAKF,MAAL,CAAYS,EAAZ,CAAe,SAAf,EAA0B,MAAKP,IAAL,CAAU,SAAV,CAA1B;AACA;AAhByB;AAiB1B;;;;uBAEII,G,EAAK;AACT,QAAKN,MAAL,CAAYU,IAAZ,CAAiBJ,GAAjB;AACA;;;uBAEIK,C,EAAG;AAAA;;AACP,UAAO,UAACC,MAAD,EAAY;AAClB,WAAKL,IAAL,CAAUI,CAAV,EAAaC,MAAb;AACA,IAFD;AAGA;;;;EA5B2Bf,Y","file":"ws.js","sourcesContent":["let WebSocket = null;\nlet isBrowser = false;\n\nif ('browser' !== process.title) {\n\tWebSocket = require('ws');\n}else{\n\tisBrowser = true;\n\tWebSocket = window.WebSocket;\n}\n\nlet EventEmitter = require(\"events\").EventEmitter;\n\nexport default class extends EventEmitter {\n\tconstructor(host, options) {\n\t\tsuper();\n\t\tif(isBrowser) {\n\t\t\tthis.client = new WebSocket(host);\n\t\t\tthis.client.onerror = this.fire('error');\n\t\t\tthis.client.onclose = this.fire('close');\n\t\t\tthis.client.onopen = this.fire('open');\n\t\t\tthis.client.onmessage = (msg) => {\n\t\t\t\tthis.emit('message', msg.data);\n\t\t\t}\n\t\t}else{\n\t\t\tthis.client = new WebSocket(host, options);\n\t\t\tthis.client.on('error', this.fire('error'));\n\t\t\tthis.client.on('close', this.fire('close'));\n\t\t\tthis.client.on('open', this.fire('open'));\n\t\t\tthis.client.on('message', this.fire('message'));\n\t\t}\n\t}\n\n\tsend(msg) {\n\t\tthis.client.send(msg);\n\t}\n\n\tfire(e) {\n\t\treturn (params) => {\n\t\t\tthis.emit(e, params)\n\t\t}\n\t}\n}\n\n"]}