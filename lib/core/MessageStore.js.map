{"version":3,"sources":["core/MessageStore.js"],"names":["requestId","messages","message","onAck","rid","getRequestId","push","id","cb","args","m","filter","shift"],"mappings":";;;;;;;;;;;AAEC,mBAAc;AAAA;;AACb,OAAKA,SAAL,GAAiB,CAAjB;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA;;;;sBAEGC,O,EAASC,K,EAAO;AACnB,OAAIC,MAAM,KAAKC,YAAL,EAAV;AACA,QAAKJ,QAAL,CAAcK,IAAd,CAAmB;AAClBC,QAAIH,GADc;AAElBF,aAASA,OAFS;AAGlBM,QAAIL;AAHc,IAAnB;AAKA,UAAOC,GAAP;AACA;;;0BAEOA,G,EAAKK,I,EAAM;AAClB,OAAIC,IAAI,KAAKT,QAAL,CAAcU,MAAd,CAAqB,UAACD,CAAD;AAAA,WAAKA,EAAEH,EAAF,KAASH,GAAd;AAAA,IAArB,EAAwC,CAAxC,CAAR;AACA,OAAGM,KAAKA,EAAEF,EAAV,EAAcE,EAAEF,EAAF,CAAK,IAAL,EAAWC,IAAX;AACd,QAAKR,QAAL,GAAgB,KAAKA,QAAL,CAAcU,MAAd,CAAqB,UAACD,CAAD;AAAA,WAAKA,EAAEH,EAAF,KAASH,GAAd;AAAA,IAArB,CAAhB;AACA;;;wBAEK;AACL,OAAIF,UAAU,KAAKD,QAAL,CAAcW,KAAd,EAAd;AACA,OAAGV,OAAH,EACC,OAAOA,OAAP,CADD,KAGC,OAAO,IAAP;AACD;;;iCAEc;AACd,OAAG,KAAKF,SAAL,GAAiB,MAApB,EAA4B,KAAKA,SAAL,GAAiB,CAAjB;AAC5B,UAAO,KAAKA,SAAL,EAAP;AACA","file":"MessageStore.js","sourcesContent":["export default class {\n\n\tconstructor() {\n\t\tthis.requestId = 0;\n\t\tthis.messages = []\n\t}\n\n\tadd(message, onAck) {\n\t\tlet rid = this.getRequestId();\n\t\tthis.messages.push({\n\t\t\tid: rid,\n\t\t\tmessage: message,\n\t\t\tcb: onAck\n\t\t})\n\t\treturn rid;\n\t}\n\n\trecvAck(rid, args) {\n\t\tlet m = this.messages.filter((m)=>m.id === rid)[0];\n\t\tif(m && m.cb) m.cb(null, args); \n\t\tthis.messages = this.messages.filter((m)=>m.id !== rid);\n\t}\n\n\tenq() {\n\t\tlet message = this.messages.shift();\n\t\tif(message)\n\t\t\treturn message;\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tgetRequestId() {\n\t\tif(this.requestId > 100000) this.requestId = 0;\n\t\treturn this.requestId++;\n\t}\n}"]}