{"version":3,"sources":["core/MessageStore.js"],"names":["requestId","messages","message","onAck","rid","getRequestId","e","push","id","cb","args","m","filter","shift"],"mappings":";;;;;;;;;;;AAEC,mBAAc;AAAA;;AACb,OAAKA,SAAL,GAAiB,CAAjB;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA;;;;sBAEGC,O,EAASC,K,EAAO;AACnB,OAAIC,MAAM,KAAKC,YAAL,EAAV;AACAH,WAAQI,CAAR,GAAYF,GAAZ;AACA,QAAKH,QAAL,CAAcM,IAAd,CAAmB;AAClBC,QAAIJ,GADc;AAElBF,aAASA,OAFS;AAGlBO,QAAIN;AAHc,IAAnB;AAKA;;;0BAEOC,G,EAAKM,I,EAAM;AAClB,OAAIC,IAAI,KAAKV,QAAL,CAAcW,MAAd,CAAqB,UAACD,CAAD;AAAA,WAAKA,EAAEH,EAAF,KAASJ,GAAd;AAAA,IAArB,EAAwC,CAAxC,CAAR;AACA,OAAGO,KAAKA,EAAEF,EAAV,EAAcE,EAAEF,EAAF,CAAKC,IAAL;AACd,QAAKT,QAAL,GAAgB,KAAKA,QAAL,CAAcW,MAAd,CAAqB,UAACD,CAAD;AAAA,WAAKA,EAAEH,EAAF,KAASJ,GAAd;AAAA,IAArB,CAAhB;AACA;;;wBAEK;AACL,OAAIF,UAAU,KAAKD,QAAL,CAAcY,KAAd,EAAd;AACA,OAAGX,OAAH,EACC,OAAOA,QAAQA,OAAf,CADD,KAGC,OAAO,IAAP;AACD;;;iCAEc;AACd,OAAG,KAAKF,SAAL,GAAiB,MAApB,EAA4B,KAAKA,SAAL,GAAiB,CAAjB;AAC5B,UAAO,KAAKA,SAAL,EAAP;AACA","file":"MessageStore.js","sourcesContent":["export default class {\n\n\tconstructor() {\n\t\tthis.requestId = 0;\n\t\tthis.messages = []\n\t}\n\n\tadd(message, onAck) {\n\t\tlet rid = this.getRequestId();\n\t\tmessage.e = rid;\n\t\tthis.messages.push({\n\t\t\tid: rid,\n\t\t\tmessage: message,\n\t\t\tcb: onAck\n\t\t})\n\t}\n\n\trecvAck(rid, args) {\n\t\tlet m = this.messages.filter((m)=>m.id === rid)[0];\n\t\tif(m && m.cb) m.cb(args); \n\t\tthis.messages = this.messages.filter((m)=>m.id !== rid);\n\t}\n\n\tenq() {\n\t\tlet message = this.messages.shift();\n\t\tif(message)\n\t\t\treturn message.message;\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tgetRequestId() {\n\t\tif(this.requestId > 100000) this.requestId = 0;\n\t\treturn this.requestId++;\n\t}\n}"]}