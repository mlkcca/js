{"version":3,"sources":["cache/index.js"],"names":["options","spanList","ts","data","span","push","_combine","reduce","acc","s","length","combine","concat","limit","i","query"],"mappings":";;;;;;;;AAAA;;;;;;;;;AAIE,kBAAaA,OAAb,EAAsB;AAAA;;AACpB,SAAKC,QAAL,GAAgB,EAAhB;AACD;;;;wBAEIC,E,EAAIC,I,EAAM;AACb,UAAIC,OAAO,mBAASF,EAAT,EAAaC,IAAb,CAAX;AACA,WAAKF,QAAL,CAAcI,IAAd,CAAmBD,IAAnB;AACA,WAAKE,QAAL;AACD;;;+BAEW;AACV,WAAKL,QAAL,GAAgB,KAAKA,QAAL,CAAcM,MAAd,CAAqB,UAACC,GAAD,EAAMC,CAAN,EAAY;AAC/C,YAAID,IAAIE,MAAJ,KAAe,CAAnB,EAAsB;AACpB,iBAAO,CAACD,CAAD,CAAP;AACD,SAFD,MAEO;AACL,cAAID,IAAI,CAAJ,EAAOG,OAAP,CAAeF,CAAf,CAAJ,EAAuB;AACrB,mBAAOD,GAAP;AACD,WAFD,MAEO;AACL,mBAAOA,IAAII,MAAJ,CAAW,CAACH,CAAD,CAAX,CAAP;AACD;AACF;AACF,OAVe,EAUb,EAVa,CAAhB;AAWD;;;0BAEMP,E,EAAIW,K,EAAO;AAChB,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKb,QAAL,CAAcS,MAAlC,EAA0CI,GAA1C,EAA+C;AAC7C,YAAIL,IAAI,KAAKR,QAAL,CAAca,CAAd,CAAR;AACA,YAAIX,OAAOM,EAAEM,KAAF,CAAQb,EAAR,EAAYW,KAAZ,CAAX;AACA,YAAIV,SAAS,IAAb,EAAmB;AACjB,iBAAOA,IAAP;AACD;AACF;AACD,aAAO,IAAP;AACD","file":"index.js","sourcesContent":["import Span from './span'\n\n// desc cache\nexport default class {\n  constructor (options) {\n    this.spanList = []\n  }\n\n  add (ts, data) {\n    let span = new Span(ts, data)\n    this.spanList.push(span)\n    this._combine()\n  }\n\n  _combine () {\n    this.spanList = this.spanList.reduce((acc, s) => {\n      if (acc.length === 0) {\n        return [s]\n      } else {\n        if (acc[0].combine(s)) {\n          return acc\n        } else {\n          return acc.concat([s])\n        }\n      }\n    }, [])\n  }\n\n  query (ts, limit) {\n    for (var i = 0; i < this.spanList.length; i++) {\n      let s = this.spanList[i]\n      let data = s.query(ts, limit)\n      if (data !== null) {\n        return data\n      }\n    }\n    return null\n  }\n}\n"]}