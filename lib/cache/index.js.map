{"version":3,"sources":["cache/index.js"],"names":["options","spanList","ts","data","span","push","combine","reduce","acc","s","length","concat","limit","i","query"],"mappings":";;;;;;;;AAAA;;;;;;;;;AAIC,iBAAYA,OAAZ,EAAqB;AAAA;;AACpB,OAAKC,QAAL,GAAgB,EAAhB;AACA;;;;sBAEGC,E,EAAIC,I,EAAM;AACb,OAAIC,OAAO,mBAASF,EAAT,EAAaC,IAAb,CAAX;AACA,QAAKF,QAAL,CAAcI,IAAd,CAAmBD,IAAnB;AACA,QAAKE,OAAL;AACA;;;4BAES;AACT,QAAKL,QAAL,GAAgB,KAAKA,QAAL,CAAcM,MAAd,CAAqB,UAACC,GAAD,EAAMC,CAAN,EAAY;AAChD,QAAGD,IAAIE,MAAJ,IAAc,CAAjB,EAAoB;AACnB,YAAO,CAACD,CAAD,CAAP;AACA,KAFD,MAEK;AACJ,SAAGD,IAAI,CAAJ,EAAOF,OAAP,CAAeG,CAAf,CAAH,EAAsB;AACrB,aAAOD,GAAP;AACA,MAFD,MAEK;AACJ,aAAOA,IAAIG,MAAJ,CAAW,CAACF,CAAD,CAAX,CAAP;AACA;AACD;AACD,IAVe,EAUb,EAVa,CAAhB;AAWA;;;wBAEKP,E,EAAIU,K,EAAO;AAChB,QAAI,IAAIC,IAAE,CAAV,EAAYA,IAAI,KAAKZ,QAAL,CAAcS,MAA9B,EAAqCG,GAArC,EAA0C;AACzC,QAAIJ,IAAI,KAAKR,QAAL,CAAcY,CAAd,CAAR;AACA,QAAIV,OAAOM,EAAEK,KAAF,CAAQZ,EAAR,EAAYU,KAAZ,CAAX;AACA,QAAGT,SAAS,IAAZ,EAAkB;AACjB,YAAOA,IAAP;AACA;AACD;AACD,UAAO,IAAP;AACA","file":"index.js","sourcesContent":["import Span from './span';\n\n//desc cache\nexport default class {\n\tconstructor(options) {\n\t\tthis.spanList = [];\n\t}\n\n\tadd(ts, data) {\n\t\tlet span = new Span(ts, data);\n\t\tthis.spanList.push(span);\n\t\tthis.combine();\n\t}\n\n\tcombine() {\n\t\tthis.spanList = this.spanList.reduce((acc, s) => {\n\t\t\tif(acc.length == 0) {\n\t\t\t\treturn [s];\n\t\t\t}else{\n\t\t\t\tif(acc[0].combine(s)) {\n\t\t\t\t\treturn acc;\n\t\t\t\t}else{\n\t\t\t\t\treturn acc.concat([s]);\n\t\t\t\t}\n\t\t\t}\n\t\t}, []);\n\t}\n\n\tquery(ts, limit) {\n\t\tfor(var i=0;i < this.spanList.length;i++) {\n\t\t\tlet s = this.spanList[i];\n\t\t\tlet data = s.query(ts, limit)\n\t\t\tif(data !== null) {\n\t\t\t\treturn data;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n"]}